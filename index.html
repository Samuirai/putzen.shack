<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN" "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">
<html>
    <head>
	    <title>putzen.shack</title>
	    <link rel="stylesheet" type="text/css" href="style.css">
	    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
	    <script src="jquery.js" type="text/javascript"></script>
    </head>
    <body>
    	<div style="float: left;">
	    	<canvas style="border: 1px solid #000000;" id="screen" width="500" height="500">
	    	</canvas>
	    	<br/>
	    	<input type="button" value="GO!" onClick="go">
    	</div>
    	<div style="float: left;">
	    	<div id="tasks">
	    	</div>
    	</div>
    	<script>
    	
    		var canvas = document.getElementById("screen");
	        var context = canvas.getContext("2d");
	        var _cfg_anz_particles = 20;
	        var _cfg_anz_particle_waves = 10;
	        var _cfg_tasks = new Array(
	        	    "frische hand- und geschirrtuecher: im lager, rechter gang links, 2.+3. regalfeld",
    				"waesche: lager, rechter gang links, 2. regalfeld, waschkorb",
    				"klopapier: getraenkelager. schluessel am schluesselbund in der lounge.",
    				"seife im kanister: kueche unter der spuehle & damenklo",
    				"spuehlmaschinentabs: kueche unter der spuehle",
    				"frische putzlappen: kueche unter der spuehle",
    				"besen & putzzeug: damenklo",
					"muelltonnen: auf dem parkplatz vor der tuer: schwarz mit gelben deckel (restmuell) und blau (papier). schluessel am schluesselbund in der lounge.",
					"neue muellsaecke / gelbe saecke: lager, direkt gegenueber dem eingang",
    				"abholung gelbe saecke: der oberleitungsmast am parkplatz",
    				"eimer, putzmittel: damenklo",
    				"abfuhrtermin: kalender rechts neben dem matomaten.",
    				"staubsauger: lager, linker gang, links hinten",
    				"staubsauger-beutel: linker gang, geradeaus hinten",
    				"elab: es gibt beschriftungen an den schubladen. kleinteile (schrauben, bauteile) im aschenbecher sammeln.",
    				"bodenputzgeraet: putzwagen, mob, wasser, reiniger gibt's auf der damenklo"
	        );
	        
	        var Particles = new Array();
	        
	        // method to update the particle position and age
	        function updateParticle() {
		        this.x += this.dx;
		        this.y += this.dy;
		        this.life -= 1;
	        }
	        
	        // Particle Class
	        function Particle (_x,_y,_dir,_speed,_life) {
			    this.x = parseInt(_x);
			    //alert(this.x)
			    this.y = parseInt(_y);
			    this.dir = _dir;
			    this.speed = 2*_speed
			    // calculate delta x and delta y for updates
			    this.dx = Math.sin(this.dir)*this.speed;
			    this.dy = Math.cos(this.dir)*this.speed;
			    this.update = updateParticle;
			    //        random age + minimum age
			    this.life = 100*_life+50;
			}
			
				   
	        // init the particles
	        function initParticles() {
	        	// wenn X% oder weniger Partikel vorhanden sind, spawne neue, bis particle waves = 0 sind
	        	if(Particles.length < _cfg_anz_particles/5 && _cfg_anz_particle_waves>0) {
		        	_cfg_anz_particle_waves -= 1;
			        for(i = 0; i<_cfg_anz_particles; ++i) {
			        	// create Particles              center of screen               random direction
				        Particles.push(new Particle(canvas.width/2, canvas.height/2, Math.random()*2*Math.PI,Math.random(),Math.random()));
			        }
		        }
	        }
	        
	        // loop over the Particles update them and paint them on the screen
	        function drawParticles() {
	        	// begin draw line path
		        context.beginPath();
		        // loop over particles
		        for(_particle in Particles) {
		        	// get the current particle
		        	p = Particles[_particle];
			        p.update();
			        // draw the line
			        context.moveTo(p.x, p.y);
					context.lineTo(p.x+p.dx*10, p.y+p.dy*10);
					// delete if life is over
					if(p.life <= 0) Particles.splice(_particle, 1);
		        }
		        // show the lines
		       	context.fill();
				context.stroke();
				context.closePath();
	        }
	        
	        // game loop
    		function loop(){
	            // clear canvas
	            context.clearRect(0, 0, canvas.width, canvas.height); 
	            // set font
	            context.font = 'Normal 20px Monospace';
	            // draw the numbers randomly
	            drawNumbes(true);
	            // add particles
	            initParticles()
	            // update and draw particles
	            drawParticles();
	        }
	        
	        // draws the numbers randomly
	        function drawNumbes(random) {
	        	// loop over all tasks from the config _cfg_tasks
	        	for (_task_nr in _cfg_tasks)
				{
					var border = 20;
					// generate random x coordinate minus a border
					var _x = parseInt(Math.random()*(canvas.width-(border*2)));
					// generate random x coordinate minus a border
					var _y = parseInt(Math.random()*(canvas.height-(border*2)));
					context.fillStyle = "rgb(255,0,0)";
					context.fillRect (_x+border, _y+border-15, 20, 20); 
		  			context.fillStyle = "rgb(0,0,0)"; 
		  			context.fillText(_task_nr, _x+border, _y+border); 
				}
				window.setTimeout("loop()",10);
	        }
	        
	        // START and init 
	        window.onload = function(){
	        	
	        	// create the task table from the config _cfg_tasks
	        	var tmp_table = "";
	        	tmp_table += "<table>"
		    	for (_task_nr in _cfg_tasks)
				{
					tmp_table += "<tr><td><b>"+_task_nr+"</b></td><td>"+_cfg_tasks[_task_nr]+"</td></tr>";
				}
				tmp_table += "</table>"
				// write the table in the 
				var div_task_list = document.getElementById("tasks"); 
				div_task_list.innerHTML = tmp_table;
				// line drawing inits
	            context.strokeStyle = '#000';
				context.lineWidth   = 2;
			    context.fillStyle = "rgb(0,0,0)"; 
			    
	            window.setTimeout("loop()",100);
	            initParticles();
	       }
    	</script>
  	</body>
</head>